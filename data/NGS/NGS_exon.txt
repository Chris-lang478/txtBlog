单基因遗传病的生信分析流程：SNP、Indel等(NGS_exon WES)


WES数据一般用于SNP和Indel分析，不能用于CNA和SA的分析。



========================================
单基因遗传病分析(SNP/Indel)的主要流程和软件
----------------------------------------

1.主要流程 
质控->比对得到map->BAM处理->call突变->合并gvcf

参考GATK Germline Best Practice





2.SNP分析所需软件(来自诺禾致源的说明书)

分析内容	软件	备注	版本
1).比对	BWA、Samblaster	测序结果与参考基因组进行比对，得到bam结果	0.1.22
        Sambamba	标记重复read	v0.4.7
2).SNP/INDEL检测	SAMtools	检测、过滤SNP及INDEL变异	1.0
3).CNV检测	control-FREEC	检测样本CNV	v6.7
4).变异功能注释	ANNOVAR	对检测到的变异进行结构和功能注释	2013Aug23






参考序列比对分析结果
有效测序数据通过 BWA(version 0.7.8-r455)比对到人类参考基因组(UCSC hg19)，得到 BAM 格式的最初的比对结果。
在最初的比对结果的基础上做如下处理:
(1) 用samblaster（Version 0.1.21）从最初的比对结果中挑选split reads和discord reads；
(2) 用sambamba（0.6.6）对比对结果进行排序和merge;
(3) 用sambamba去除重复的reads。经过以上处理，得到 BAM 格式的最终比对结果。

后续变异检测基于这个比对结果。
如果一个或一对read(s)在基因上可以有多个比对位置，BWA的处理策略是从中 选择一个最好的，如果有两个或以上最好的比对位置，则从中随机选择一个。这种多重比对(multiple hit)的处理对 SNP、indel 以及 CNV 等的检测有重要影响。通常检测 SNP 或 INDEL 的时候要使用高质量的比对(alignment)，即比对质量值大于0或更高。

本文件夹下包含每个样本(样本名)的比对结果数据结果文件:
1.后缀 bam 文件 比对结果文件
2.后缀.bam.bai文件 对bam文件构建索引，用于对bam文件的快速处理

结果文件说明:
1.后缀 bam 文件是 sam 文件的压缩格式，解读请参考附件 SAMv1.pdf
2.后缀 bam.bai 文件是由命令 sambamba index *.bam 得到





3.外显子测序结题报告
https://wenku.baidu.com/view/ff8cd0f3f424ccbff121dd36a32d7375a417c6bb.html
1)对raw data 过滤，得到clean reads
	- 过滤掉 reads 的接头序列
	- SE测序低质量碱基数超过该reads的50%时，舍弃该reads
	- SE reads中的N碱基超过10%时，舍弃该reads
	- fastqc统计：reads数量、数据产量、质量分布。
2)使用BWA比对到参考基因组GRCh38上
3)使用Picard去除重复reads
4)使用GATK做局部重比对和碱基质量校正[好像已经去掉了]
5)基于比对结果，统计每个样品的测序深度、覆盖度、比对率等评价指标

6)使用 GATK 的HaplotypeCaller检测基因组变异，包括SNP和Indel
7)使用基于深度信号方法的 CNVnator v0.2.7检测拷贝数变异CNV
8)使用Breakdancer或者CREST检测结构变异
9)使用SnpEff软件对变异结果进行注释及影响预测。







========================================
Seqtools 及 参考基因组 及参考文献
----------------------------------------
1.参考基因组的md5sum值：https://taichimd.us/mediawiki/index.php/Seqtools
BRB-SeqTools： https://linus.nci.nih.gov/seqtools/




2.参考基因组
(1)ClinVar使用的是hg38基因组：
https://www.ncbi.nlm.nih.gov/clinvar/RCV000139793/#clinical-assertions



(2)refGene.txt 的说明：
$ head refGene.txt -n 2
75      NM_001172656    chr4    -       2271323 2420370 2272451 2420050 12      2271323,2273037,2273401,2274899,2275788,2306015,2321896,2339133,2341179,2343204,2355659,2420011,        2272583,2273141,2273506,2275016,2275943,2307263,2321998,2339223,2341382,2343342,2355800,2420370,    0       ZFYVE28 cmpl    cmpl    0,1,1,1,2,2,2,2,0,0,0,0,

每列的解释：http://genome.ucsc.edu/cgi-bin/hgTables

wget -c -O mm9.refGene.txt.gz http://hgdownload.soe.ucsc.edu/goldenPath/mm9/database/refGene.txt.gz
wget -c -O mm10.refGene.txt.gz http://hgdownload.soe.ucsc.edu/goldenPath/mm10/database/refGene.txt.gz
wget -c -O hg19.refGene.txt.gz http://hgdownload.soe.ucsc.edu/goldenPath/hg19/database/refGene.txt.gz
wget -c -O hg38.refGene.txt.gz http://hgdownload.soe.ucsc.edu/goldenPath/hg38/database/refGene.txt.gz

$ gunzip hg38.refGene.txt.gz
$ less -S hg38.refGene.txt

提取其中的带有geneID的一列，并且没有重复
$ awk '{print $7}' refGene.list.txt | sort -u > uniqu.refGene.list.txt
查看列数
$ wc -l uniqu.refGene.list.txt 




(3)GTF格式的refGene如何在Ensembl及UCSC下载
http://blog.sina.com.cn/s/blog_751bd9440102v76a.html


(4) igenome
http://jp.support.illumina.com/sequencing/sequencing_software/igenome.html





3.单基因遗传病文章

单基因遗传病——家系样本研究思路
基因测序产业网  2016-05-06

[1] https://en.wikipedia.org/wiki/Genetic_disorder

[2] Feng R, Sang Q, Kuang Y,et al. Mutationgs in TUBB8 and Human Oocyte Meiotic Arrest. N Engl J Med. 2016, 374(3): 223-32. 
外显子组测序解析卵细胞发育障碍


[3] Lukacs V, Mathur J, Mao R, et al. Imparied PIEZO1 function in patients with a novel autosomal recessive congentital lymphatic dysplasia. Nat Commun. 2015, 6: 8329.
外显子组测序解析常染色体隐性先天性淋巴管发育不良


最全！华大基因单基因遗传病检测科研成果汇编
原创： 华大医学  华大医学  2018.9月3日



========================================
ClinVar数据库统计单基因遗传病致病位点人群频率
----------------------------------------
原创： 基因游侠  基因检测与解读  2018.5月1日

评估一个基因位点是否为患者的致病基因，游侠认为需要从三个方面来考虑，
第一是临床评估，即该基因在数据库（如OMIM）中记录的表型是否与患者的表型想符合，
第二是生物信息学评估，包括正常人群频率、突变类型、软件预测、序列保守性等等，
第三是遗传模式评估，即如果是隐性遗传是否为父母（父母正常）分别携带一个位点，如果是显性遗传是否为新发突变（父母正常）。

万分之一，后来的实际工作中发现这个cutoff过于严谨，容易把真阳性位点排除。


首先我们从ClinVar官网下载最新的VCF，下载地址为
ftp://ftp.ncbi.nlm.nih.gov/pub/clinvar/vcf_GRCh37/
ftp://ftp.ncbi.nlm.nih.gov/pub/clinvar/vcf_GRCh38/

个人推荐对于隐性遗传基因cutoff设为0.005或0.01，对于显性遗传基因cutoff设为0.001或0.005，以上只是初步粗略统计，推荐cutoff仅供参考，谢谢！





========================================
fastq数据的过滤、修剪、错误去除和质控[fastqc + cutadapt]
----------------------------------------
1.质控用fastqc
http://www.bioinformatics.babraham.ac.uk/projects/fastqc/

$ fastqc --version
FastQC v0.11.5

-o参数，指定输出到文件夹


This has some good examples: http://www.bioinformatics.babraham.ac.uk/projects/fastqc/
Then you can look into the following: Trimmomatic, Fastx-toolkit to trim data.


更多质控软件： http://blog.sina.com.cn/s/blog_9b78c9110101couq.html





2.质控的参数：
http://www.biotrainee.com/thread-324-1-1.html

(1)如果测序质量不合格，则需要：
fastq_quality_filter -v -Q 64 -q 20 -p 75 -i sample.fastq -o sample_filtered.fastq

(2)如果都是reads的前6个bp碱基有问题，则需要
fastx_trimmer -v -f 7 -l 36 -i sample_filtered.fastq -o sample_filtered_and_trimmed.fastq

(3)如果混入了大量的接头，则需要！
cutadapt -m 20 -e 0.1 -a GATCGGAAGAGCACACGTCTGAACTCCAGTCACACA sample2.fastq \ -o sample2--cutadapt.fastq
需要自己去查自己的接头是什么序列：https://github.com/csf-ngs/fastq ... ontaminant_list.txt

质控可视化：
(A) Average quality score for each base position, 
(B) GC content distribution, 
(C) Average Phred quality score distribution, 
(D) Base composition and 
(E) read length distribution for both input (red) and HQ filtered (green) data. 
(F) Percentage of reads with different quality score ranges at each base position. 

如果是特殊测序，质控需要加一些步骤
WES：??


问题：如果双端测序，有一个被过滤掉了，下一步bwa比对不通过怎么办？http://www.biotrainee.com/thread-324-1-1.html
解答：用cutadapt软件来对双端测序数据去除接头 http://www.bio-info-trainee.com/1920.html
Posted on 2016年10月6日
一般来讲，我们对测序数据进行QC，就三个大的方向：Quality trimming， Adapter removal， Contaminant filtering。
当我们是双端测序数据的时候，去除接头时，也会丢掉太短的reads，就容易导致左右两端测序文件reads数量不平衡，有一个比较好的软件能解决这个问题，我比较喜欢的是cutadapt软件的PE模式来去除接头！尤其是做基因组或者转录组de novo 组装的时候，尤其要去掉接头，去的干干净净！

既然fastqc能探测到你的接头，说明它里面内置了所有的接头序列，在github可以查到：https://github.com/csf-ngs/fastqc/blob/master/Contaminants/contaminant_list.txt
或者：Download common Illumina adapters from   https://github.com/vsbuffalo/scythe/blob/master/illumina_adapters.fa
TruSeq Universal Adapter AATGATACGGCGACCACCGAGATCTACACTCTTTCCCTACACGACGCTCTTCCGATCT
Illumina Small RNA 3p Adapter 1 ATCTCGTATGCCGTCTTCTGCTTG
最严重的一般是TruSeq Universal Adapter ， 而且它检测到你其它的接头可能就是这个 TruSeq Universal Adapter 的一部分而已~！ 




3.剪切接头
$ cutadapt --version
1.18

See https://cutadapt.readthedocs.io/ for full documentation.
https://www.biomart.cn/news/16/2842104.htm

测试方法：
$ cutadapt -o output.fastq.gz input.fastq.gz
$ tail -n 4 input.fastq | cutadapt -a AACCGGTT

## PE reads
$ cutadapt -a ADAPTER_FWD -A ADAPTER_REV -o out.1.fastq -p out.2.fastq reads.1.fastq reads.2.fastq
-p is the short form of --paired-output. 


看图，需要除掉低质量的碱基。
$ cutadapt -e 0.1 -j 5 -q 32 -m 100 --pair-filter=both -o out.1.fastq -p out.2.fastq ../0_fastqc/B1709060700_NDHE00383-A84-A68_AH7277CCXY_L7_1.fq ../0_fastqc/B1709060700_NDHE00383-A84-A68_AH7277CCXY_L7_2.fq


要用PE模式来去除接头，保证过滤后的reads还是数量继续平衡的。
--pair-filter=both
 Processing reads on 5 cores in paired-end legacy mode ...
 WARNING: Legacy mode is enabled. Read modification and filtering options *ignore* the second read. To switch to regular paired-end mode, provide the --pair-filter=any option or use any of the -A/-B/-G/-U/--interleaved options.

--max-n=COUNT  Discard reads with more than COUNT 'N' bases. If COUNT在0和1之间，则为比例。
-e 0.1 错误率超过10%舍弃。-e 引物匹配允许错误率，我调置0.15，一般引物20bp长允许3个错配，为了尽量把引物切干净 
-j N 或者--cores=N 多核
-O 5 Require MINLENGTH overlap between read and adapter for an adapter to be found. Default: 3
-q 30 3'端质量低于30的舍弃
-m 100 去除接头后如果read长度小于50舍弃
-o 输出文件
-p 另一个输出文件


$ cutadapt -e 0.1 -j 5 -q 32 -m 100 --pair-filter=both -o out.1.fastq -p out.2.fastq ../0_fastqc/B1709060700_NDHE00383-A84-A68_AH7277CCXY_L7_1.fq ../0_fastqc/B1709060700_NDHE00383-A84-A68_AH7277CCXY_L7_2.fq

Finished in 443.18 s (11 us/read; 5.43 M reads/minute).
=== Summary ===

Total read pairs processed:         40,082,567
  Read 1 with adapter:                       0 (0.0%)
  Read 2 with adapter:                       0 (0.0%)
Pairs that were too short:           1,112,243 (2.8%)
Pairs written (passing filters):    38,970,324 (97.2%)

Total basepairs processed: 12,024,770,100 bp
  Read 1: 6,012,385,050 bp
  Read 2: 6,012,385,050 bp
Quality-trimmed:             731,635,203 bp (6.1%)
  Read 1:   254,589,325 bp
  Read 2:   477,045,878 bp
Total written (filtered):  11,201,702,911 bp (93.2%)
  Read 1: 5,704,317,713 bp
  Read 2: 5,497,385,198 bp
-






========================================
比对：BWA的安装 与使用
----------------------------------------
1.http://bio-bwa.sourceforge.net/

BWA is a software package for mapping low-divergent sequences against a large reference genome, such as the human genome. It consists of three algorithms: BWA-backtrack, BWA-SW and BWA-MEM. The first algorithm is designed for Illumina sequence reads up to 100bp, while the rest two for longer sequences ranged from 70bp to 1Mbp. BWA-MEM and BWA-SW share similar features such as long-read support and split alignment, but BWA-MEM, which is the latest, is generally recommended for high-quality queries as it is faster and more accurate. BWA-MEM also has better performance than BWA-backtrack for 70-100bp Illumina reads.

BWA适用于变异比对。



2.下载
https://sourceforge.net/projects/bio-bwa/files/

https://github.com/lh3/bwa/releases
$ wget https://github.com/lh3/bwa/releases/download/v0.7.17/bwa-0.7.17.tar.bz2
$ tar -xjvf bwa-0.7.17.tar.bz2
$ cd bwa-0.7.17
$ make #报错


说明文件是这么说的：
git clone https://github.com/lh3/bwa.git
cd bwa; make
./bwa index ref.fa
./bwa mem ref.fa read-se.fq.gz | gzip -3 > aln-se.sam.gz
./bwa mem ref.fa read1.fq read2.fq | gzip -3 > aln-pe.sam.gz

最终是这么安装的：
$ sudo yum install bwa
版本号：
Program: bwa (alignment via Burrows-Wheeler transformation)
Version: 0.5.9-r16
发现版本太低，重新安装。


使用 sudo make 结果正常。
bwa 0.7.17-r1188

########




3.比对

Does BWA call SNPs like MAQ?
No, BWA only does alignment. Nonetheless, it outputs alignments in the SAM format which is supported by several generic SNP callers such as samtools and GATK.
比对之后去重，
然后用samtools或者GATK call SNP。

http://bio-bwa.sourceforge.net/bwa.shtml


(1)建立索引
参考基因组
$ ls -lth /home/data/Homo_sapiens/UCSC/hg38/Sequence/WholeGenomeFasta/genome.fa
-rwxrwxr-x. 1 wangjl wangjl 3.0G Aug 19  2015 /home/data/Homo_sapiens/UCSC/hg38/Sequence/WholeGenomeFasta/genome.fa


Algorithm for constructing BWT index. Available options are:
有两种建立参考基因组的策略：
is	IS linear-time algorithm for constructing suffix array. It requires 5.37N memory where N is the size of the database. IS is moderately fast, but does not work with database larger than 2GB. IS is the default algorithm due to its simplicity. The current codes for IS algorithm are reimplemented by Yuta Mori.
is 相对快，但是参考基因组不能大于2GB。
bwtsw	Algorithm implemented in BWT-SW. This method works with the whole human genome.
bwtsw能用于人全基因组分析。

https://zhuanlan.zhihu.com/p/36267250
-a指定建立索引的算法，bwtsw，is或者rb2，以前没有rb2，而是div。is还是适合小于2G的基因组，bwtwt是大于10M的基因组才行，这个地方不要选错了，细菌基因组一般都小于10M，只能用is算法，人基因组是3G，只能用bwtsw，处于中间的选择哪个都可以。


$ pwd
/home/data/Homo_sapiens/UCSC/hg38/Sequence/BWAIndex/version0.7.x
$ bwa index genome.fa
##14:51 to 16:05
#...
##[BWTIncConstructFromPacked] 680 iterations done. 6184133946 characters processed.
生成 hg19.fasta.amb、hg19.fasta.ann、hg19.fasta.bwt、hg19.fasta.pac、hg19.fasta.sa 五个文件。
#[main] Version: 0.7.17-r1188 
#[main] CMD: bwa index genome.fa
#[main] Real time: 4420.476 sec(73min); CPU: 4367.864 sec


好像不对，人基因组大于3GB，应该使用另一种索引方式：
$ bwa index -a bwtsw genome.fa
#[main] Version: 0.7.17-r1188
#[main] CMD: bwa index -a bwtsw genome.fa
#[main] Real time: 4529.281 sec; CPU: 4443.430 sec


https://www.biostars.org/p/53546/
按照这个来看，不指定，则bwa自动选择，选择的依据还是基因组大小。
// simplified sample from bwtindex.c:
if (algo_type == "auto") {
    if (l_pac > 50000000)
        algo_type = "bwtsw";
    else
        algo_type = "is";
}
所以，我以上两个建立的索引应该是一样。
比一下md5，真的一模一样。并且和version0.6.0一模一样。






(2)比对
BWA-MEM





========================================
Samblaster
----------------------------------------

https://github.com/GregoryFaust/samblaster
https://doi.org/10.1093/bioinformatics/btu314

1.安装 (支持linux/mac OS Version 10.7以上)
$ git clone git://github.com/GregoryFaust/samblaster.git
$ cd samblaster
$ make
$ sudo cp samblaster /usr/local/bin/
$ samblaster --version
samblaster: Version 0.1.24


2.简介
Author: Greg Faust (gf4ea@virginia.edu)
Tool to mark duplicates and optionally output split reads and/or discordant pairs.
Input sam file must contain paired end data, contain sequence header and be sorted by read ids.
Output will be all alignments in the same order as input, with duplicates marked with FLAG 0x400.


refer:

2.中文
https://www.sohu.com/a/246097230_99971433




========================================
Sambamba: process your BAM data faster!（去重 比 Picard 快）
----------------------------------------
1.Picard官网：for users
http://broadinstitute.github.io/picard/

A set of command line tools (in Java) for manipulating high-throughput sequencing (HTS) data and formats such as SAM/BAM/CRAM and VCF.

2.Sambamba 官网
https://github.com/biod/sambamba

http://lomereiter.github.io/sambamba/docs/sambamba-view.html
sambamba主要有filter，merge,slice和duplicate等七个功能来处理sam/bam文件。

推荐：https://www.sohu.com/a/246097230_99971433
推荐两款sam文件处理小工具samblaster和sambamba，它们具有排序、比对信息查看等常用功能之外，最棒的是可以用来代替picard去除重复序列，在筛选标准不变的前提下速度能提升30倍以上

下载地址
https://github.com/lomereiter/sambamba/releases
安装：拷贝至全局环境变量路径即可

$ wget https://github.com/biod/sambamba/releases/download/v0.6.8/sambamba-0.6.8-linux-static.gz
$ gunzip sambamba-0.6.8-linux-static.gz
$ mv sambamba-0.6.8-linux-static sambamba
$ chmod +x sambamba
$ sudo mv sambamba /usr/local/bin/
$ sambamba -v
#sambamba 0.6.8


refer:
1.官网 http://lomereiter.github.io/sambamba/docs/sambamba-view.html
2.中文参考：
http://blog.sciencenet.cn/home.php?mod=space&uid=1094241&do=blog&id=1041577
https://www.sohu.com/a/246097230_99971433
https://blog.csdn.net/msw521sg/article/details/65938377



========================================
samtools
----------------------------------------
1.SAM (Sequence Alignment/Map) format is a generic format for storing large nucleotide sequence alignments. SAM aims to be a format that:
http://samtools.sourceforge.net/



2.安装： 
$ wget https://sourceforge.net/projects/samtools/files/latest/download
$ mv download samtools-1.9.tar.bz2
$ tar -xjvf samtools-1.9.tar.bz2
$ cd samtools-1.9
$ make 
## FAILED.  Either configure --without-curses or resolve this error to build

$ sudo yum install ncurses-devel
没用，还报错。



算了，还是yum安装吧：
$ sudo yum install samtools
$ samtools

Program: samtools (Tools for alignments in the SAM format)
Version: 0.1.18 (r982:295)

$ sudo yum remove samtools #卸载yum安装的




版本老，还是尽力安装最新的：
$ sudo ./configure
$ sudo make #不报错了
$ sudo make install

$ samtools
Program: samtools (Tools for alignments in the SAM format)
Version: 1.9 (using htslib 1.9)



========================================
bedtools: a powerful toolset for genome arithmetic
----------------------------------------
1. bedtools: flexible tools for genome arithmetic and DNA sequence analysis.
usage:    bedtools <subcommand> [options]

https://bedtools.readthedocs.io/en/latest/index.html


2.安装
https://bedtools.readthedocs.io/en/latest/content/installation.html

$ wget https://github.com/arq5x/bedtools2/releases/download/v2.25.0/bedtools-2.25.0.tar.gz
$ tar -zxvf bedtools-2.25.0.tar.gz
$ cd bedtools2
$ make

缺少  #include <zlib.h>
http://zlib.net/
$ wget http://zlib.net/zlib-1.2.11.tar.gz
$ tar zxvf zlib-1.2.11.tar.gz
$ ./configure
$ make 
$ sudo make install


还是报错。
算了，还是最简单yum安装吧：
https://bedtools.readthedocs.io/en/latest/content/installation.html
$sudo yum install BEDTools
$ bedtools -version
bedtools 2.15.0
#版本有点老，卸载
$ sudo yum remove BEDTools



重新安装新版本。
$ sudo make 
# 报错 gzstream.C:(.text+0x2a2): undefined reference to `gzopen64'

##https://bedtools.readthedocs.io/en/latest/content/faq.html
## 先确定gzopen64是否存在，再更新链接，使该函数可被调用。
$ locate libz.so | less
$ objdump -T /usr/local/lib/libz.so | grep gzopen64
## 00000000000120f0 g    DF .text  0000000000000304  ZLIB_1.2.3.3 gzopen64

$ sudo make LIBS='/usr/local/lib/libz.so'
$ sudo make install LIBS='/usr/local/lib/libz.so'

##退出再登录还是报错： bedtools: /lib64/libz.so.1: version `ZLIB_1.2.3.3' not found (required by bedtools)
$ sudo ln -sf /usr/local/lib/libz.so /lib64/libz.so.1

$ bedtools --version
bedtools v2.25.0



========================================
Control-Freec:检测拷贝数变异的神器
----------------------------------------
1. 简介
http://bioinfo-out.curie.fr/projects/freec/


Control-Freec 既可以检测拷贝数变异CNV，还可以分析杂合性缺失LOH。官网如下
http://boevalab.com/FREEC/

Control-FREEC is a tool for detection of copy-number changes and allelic imbalances (including LOH) using deep-sequencing data originally developed by the Bioinformatics Laboratory of Institut Curie (Paris). Nowdays, Control-FREEC is supported by the team of Valentina Boeva at Institut Cochin, Inserm(Paris). 

在检测拷贝数变异时，支持全基因组测序，全外显子测序，目标区域捕获测序等多种测序方案，
对于全基因组数据，分析是不需要提供对照样本；
对于全外显子测序和目标区域捕获测序，必须提供对照样本。

# Control-FREEC
Copy number and genotype annotation from whole genome and whole exome sequencing data.







2.安装准备
(1)安装必须准备
http://boevalab.com/FREEC/tutorial.html#install

10Gb of RAM
Linux or MACS OS; only older versions of Control-FREEC (up to v6.2) are available for Windows
R installed
	R version 3.5.1
samtools installed if the input files are in .BAM format
	Version: 1.9 (using htslib 1.9)
bedtools installed if you wish to create minipileup files from .BAM
	bedtools v2.25.0
sambamba installed if you wish to speed up reading of .BAM files
	sambamba 0.6.8 by Artem Tarasov and Pjotr Prins (C) 2012-2018



(2)##https://github.com/BoevaLab/FREEC/releases
$ wget -O FREEC-11.5.tar.gz https://github.com/BoevaLab/FREEC/archive/v11.5.tar.gz
$ tar xzvf FREEC-11.5.tar.gz
$ cd FREEC-11.5
在FREEC-11.4下有3个目录：
data目录保存的是配置文件的模板，包含WGS和WES两套模板；
scripts目录下是一些常用的脚本；
src目录下就是软件的源代码，freec可执行文件就位于这个目录。

$ cd src
$ make
$ make install #报错，可能必须手动安装快捷方式了

$ cd ~/bin
$ ln -s ~/Soft/FREEC-11.5/src/freec
$ freec -h
Control-FREEC v11.5 : a method for automatic detection of copy number alterations, subclones and for accurate estimation of contamination and main ploidy using deep-sequencing data





文件配置方式：http://boevalab.com/FREEC/tutorial.html#CONFIG




http://boevalab.com/FREEC/
Starting from Control-FREEC v10.6, Control-FREEC can work on exome-seq data without a control sample. 






3.Control-FREEC v11.5
$ pwd
/home/wangjl/bin
$ ln -s /home/wangjl/Soft/FREEC-11.5/src/freec



3.配置文件很复杂
http://boevalab.com/FREEC/
http://boevalab.com/FREEC/tutorial.html#CONFIG

Starting from Control-FREEC v10.6, Control-FREEC can work on exome-seq data without a control sample. 




========================================
变异功能注释 ANNOVAR
----------------------------------------
1. ANNOVAR简介(邮件注册才能下载)
官网 http://annovar.openbioinformatics.org/en/latest/
ANNOVAR是由王凯编写的一个注释软件，可以对SNP和indel进行注释，也可以进行变异的过滤筛选。

ANNOVAR能够利用最新的数据来分析各种基因组中的遗传变异。主要包含三种不同的注释方法，Gene-based Annotation（基于基因的注释）、Region-based Annotation（基于区域的注释）、Filter-based Annotation（基于筛选的注释）。

ANNOVAR由Perl编写。
优点：提供多个数据可直接下载、支持多种格式、注释直观；
缺点：没有数据库的物种无法注释。


2.安装






========================================
gatk
----------------------------------------
参考全文 https://www.cnblogs.com/nkwy2012/p/6322775.html


1.官网： https://software.broadinstitute.org/gatk/

Genome Analysis Toolkit
Variant Discovery in High-Throughput Sequencing Data

如何安装：https://www.jianshu.com/p/825e7d618838
$ wget https://github.com/broadinstitute/gatk/releases/download/4.0.11.0/gatk-4.0.11.0.zip

(2)下载序列
https://gatkforums.broadinstitute.org/gatk/discussion/1215/how-can-i-access-the-gsa-public-ftp-server

用浏览器登陆 ftp://ftp.broadinstitute.org/bundle








2.GATK Best Practices
https://software.broadinstitute.org/gatk/best-practices/
GATK4 的最佳实践给出了5套pipeline
Germline SNPs + Indels
Somatic SNVs + Indels
RNAseq SNPs + Indels
Germline CNVs
Somatic CNVs

以上五套pipeline 可以根据研究对象是DNA还是RNA进行划分：DNA 测序（包含1,2,4,5）和RNA 测序（3）。可以看到，GATK 更多的是倾向于DNA 测序数据的分析。对于DNA测序而言，主要识别SNP和CNV 两大类型的变异，每种变异类型又有Germline和Somatic的区别。

Germline指的是在胚胎发育早起出现的变异，这种变异会在所有细胞中广泛存在，是可以遗传给后代的变异；Somatic指的是体细胞变异，身体特定区域或者组织中出现的变异。通常不会遗传给后代。

在所有的pipeline之前，都存在一个数据预处理步骤data pre-processing。
GATK4 版本的最佳实践并不是直接给出了每个步骤对应的代码，而是给出了几套它们自己编写的流程，以供参考。这些流程以WDL这种workflow 语言进行编写。官方对于WDL, 也给出了详细的文档，帮助我们了解。

总结
GATK4整合了picard软件，在算法上进行了优化，新增了许多新的功能。
官网给出了基于GATK4的pipeline, 以WDL这种workflow 流程管理语言编写。



3.Quick Start Guide:Take a brief orientation tour and get started today
https://software.broadinstitute.org/gatk/documentation/quickstart.php




========================================
Picard
----------------------------------------
1.官网： A set of command line tools (in Java) for manipulating high-throughput sequencing (HTS) data and formats such as SAM/BAM/CRAM and VCF.

http://broadinstitute.github.io/picard/


2.下载
$ wget https://github.com/broadinstitute/picard/releases/download/2.18.15/picard.jar









========================================
[大纲]第十八期临床遗传病生信实操培训班（上海班）
----------------------------------------
基因游侠  基因检测与解读  2018.10月15日


“在课上系统学习了质控的三大要点，拿到检测机构的原始数据后我就可以自己评估谁的实验做的好不好了，对于阴性结果的案例，我也学会在IGV中查看感兴趣的基因有没有完全覆盖，我还知道判断一个基因是否为患者的致病基因，需要从临床、遗传模式及生物信息三个方面考虑，缺一不可！”

1.原始数据fastq到bam到vcf
2.vcf与表型相关变异关系的分析过程。



内容：

基因侦探王剑
1.NGS实验基本流程
2.新致病基因的鉴定
3.NGS数据质量控制
4.致病基因（变异）的筛选与评估
5.变异精准解读影响因素
6.NGS分析CNV
7.案例分析


基因游侠
1、CentOS系统的介绍
2、实际操作fastQC查看数据质量
3、speedseq比对原始数据
4、如何分析覆盖度与测序深度
5、GATK call突变及位点过滤
6、annovar注释及筛选
7、IGV查看reads比对情况
8、怎么分析trio新发突变
9、怎么使用Exomiser分析复合杂合变异
10、怎么筛选大家系多个样本候选位点
11、以DMD为例，利用NGS分析外显子缺失与重复
12、XYAutoFilter软件的使用
13、利用WES分析SMN1拷贝数

14、cnv分析原理与案例



========================================
[大纲]遗传病测序数据分析解读科普系列 第2期 生信分析基础：了解数据处理过程
----------------------------------------
原创： 熊吉的熊  瀚垚生物医学  2018.8月2日

1.数据前处理
	fastq ->BQSR.bam

第一部分主要讲述从fastq到可以call变异的bam文件之间主要发生了什么。
重点理解，为什么比对目前最常用的是bwa，为什么要对bam进行sort，markdup和BQSR操作。

bwa优势：快和准

bam文件对很多人的印象可能是
第一步：打开igv
第二步：载入bam文件
第三步：输入看变异



2.如何得到变异vcf文件
	bam -> vcf

重点理解GATK的HaplotypeCaller都做了什么，为什么在众多的call variant软件中，HC使用范围最广。
适当了解变异后处理过程中推荐使用人群数据和VQSR的目的。



3.qc和统计
	fastq/bam/vcf的质量评估
通过质控或统计数据判断数据的质量

当拿到处理的数据后，第一时间其实并不是进行数据解读，其实首先需要检验数据的质量，即判断是否合格，否则对一个质量不达标的数据进行下游处理，很大可能会造成时间和精力的浪费。

主要理解fastq/bam/vcf的数据质量基本判断原则。


========================================
[大纲]逸仙生信临床解读培训班第二天
----------------------------------------
廖健伟  逸仙细胞分子论坛  2018.9月9日

2018年9月9日，逸仙细胞分子论坛的首届生物信息临床解读培训班迎来了第二天的课程

1.上午首先由颜彬博士介绍人群数据库和疾病数据库的使用。人群频率数据与疾病数据是胚系变异评级分类的重要证据，人群数据库可用于获得某变异在人群中的发生频率，而发生频率的高低可作为一个预测指标，区分良性变异和致病性变异；疾病数据库可用于查找疾病相关变异并对变异的致病性进行评估。颜博士重点介绍了1000 genomes及ExAC人群数据库和ClinVar、HGMD、OMIM等疾病数据库。

2.接着，温晓君老师介绍了参考基因组及计算机预测软件。参考基因组是人类基因组计划的产物，记录基因完整的信息包括编码序列、调控序列等，随着研究的进行，参考基因组也不断更新。温老师主要介绍了参考基因组NCBI、UCSC，ensemble等数据库在基因变异解读中重要性及参考基因组的下载方式，并结合ACMG指南，以变异解读实例详细地介绍了预测软件如错义变异的预测软件SIFT、Polyphen-2，剪切预测软件MaxExtScan、NetGen2等软件的应用。

3.然后，温晓君与廖健伟博士依次作了遗传病基因变异与肿瘤基因变异的解读与病例分享。遗传病非常复杂多样，根据其变异范围大小可分为单基因多基因疾病、基因组疾病、染色体疾病。温老师首先介绍了根据不同的疾病，检测方法及策略的不同，包括一代测序、靶向测序、医学外显子、全外显子、全基因组测序，其中，重点介绍了利用医学外显子测序检测单基因遗传病的适用范围及检测流程。最后她以两个病例详细介绍了医学外显子测序辅助诊断单基因遗传病的整个流程，包括检测前遗传咨询、实验流程及数据分析、变异评级。

然而，肿瘤基因检测与遗传疑难病有所区别，除了检测胚系变异，体细胞变异的检测同样重要。而对肿瘤组织的体细胞变异，目前有推荐以用药指导作为分类标准，目的主要是指导靶向治疗。廖博士介绍了药物相关数据库如oncoKB、My cancer Genome、Clinical Trials，可作为肿瘤基因变异分类的参照。


4.下午，先由欧阳能太教授分享了NGS实验室的设计经验，讲述了实验室的功能分区、气压、温湿度等对NGS检测的重要性，并就控制实验室压差和温湿度的暖通系统作了详细介绍。

5.接着，萧晓琴老师讲解了qPCR及一代测序在临床的应用。这两种方法各有优劣，获得的信息量也大不相同，根据临床的需求进行选择，qPCR法主要用于特定基因已知热点突变的检测；一代测序主要用于单个基因的测序及基因多态性分析；也常应用于二代测序得到的变异位点的验证及家属验证。

6.然后，李晓娟博士介绍了基因芯片及FISH技术的临床应用。临床检测染色体数量及结构，FISH和基因芯片是目前仍在使用的重要方法，并且各有优势。如果是针对已知的染色体数量和结构（3-20Mb）的检测，则FISH方法可以在显示受检细胞内部染色体变化，快速、方便。如果检测更微小的结构变异，则可通过基因芯片的方法对全基因组水平中发生的5kb以上的拷贝数扩增或缺失进行检测。但针对平衡易位还是需要传统的核型分析及FISH的方法来进行原位的观察。

7.随后，廖健伟博士负责解答临床基因检测的相关咨询问题。问题涉及基因检测项目的选择、发生退费的原因、检测部位选择、报告时效差别、基因检测报告的解析等。

8.最后，蒋圆玲老师为我们介绍了NIPT的检测原理及临床应用。染色体异常疾病是新生儿出生缺陷中常见的疾病，现阶段并没有有效的治疗方法，只能通过产前诊断进行出生干预才能有效地降低出生缺陷。讲者简单介绍了传统产前筛查和产前诊断方式；然后介绍了基于高通量测序的无创产前筛查（Noninvasive Prenatal Testing, NIPT）技术，并详细从技术的的发展起源、检测原理以及在临床中应用等方面进行了介绍。



========================================
[大纲]儿童遗传分子诊断技术质控及数据一体化信息管理——新华医院的经验探索尝试
----------------------------------------
聚道科技GeneDock  聚道科技GeneDock  2018.6月22日

2018分子及遗传诊断高峰论坛于6月14-15日在上海成功举办。上海交通大学医学院附属新华医院余永国主任为大家带来题为《复杂多样的儿童遗传分子诊断技术质控及数据一体化信息管理——新华医院的经验探索尝试》的精彩报告。

随着现代生物医学技术的发展，分子诊断是精准医学实践中不可或缺的一个重要手段。遗传病的三级预防措施能够有效降低出生缺陷：
一级预防：孕前禁止近亲结婚，杂合子检出
二级预防：怀孕期羊水细胞、绒毛膜细胞的酶学、基因产前诊断
三级预防：新生儿筛查


此外，儿童疑难罕见遗传病的常规基因诊断报告，经历从发起申请、进行实验、生信分析、到出遗传报告等过程，需要45-60天的周期。为遗传病患儿的救治赢得更多宝贵时间，缩短检测各个环节的时间尤为重要。过去，检测申请、分子实验过程记录、检测报告签发等信息记录主要通过从医院系统下载上传表格，通过EXCEL记录实现。这给项目沟通、数据流通、人员协作都带来了很大的不便。

分子检测需要不同团队、各个成员沟通协作，为了确保检测结果的准确性，新华医院采取三级审核的制度。比如基因诊断报告流程：
第一review：要求产生精准的数据并运行工作流
第二review：要求分析数据，双人核对，列出依据，讨论结果
第三review：医生审核位点，一代验证，撰写报告
实验室信息化平台的搭建对促进实验室信息同步、协作带来了很大的便利，能够提高协作效率，缩短检测周期。

1.分子平台临床信息和检测自动化搭建（LIMS系统）




========================================
----------------------------------------



========================================
----------------------------------------



========================================
----------------------------------------


========================================
----------------------------------------



========================================
----------------------------------------



========================================
----------------------------------------



========================================
----------------------------------------



