NGS statistics 统计学和统计学参数

统计学尽量不写，因为太多参数
paper中常见的统计学，还是要硬啃的。



========================================
ROC曲线的意义
----------------------------------------
ROC曲线的意义
http://www.cnblogs.com/emanlee/archive/2011/05/29/2062280.html

　　ROC曲线指受试者工作特征曲线(receiver operating characteristic curve), 是反映敏感性和特异性连续变量的综合指标,是用构图法揭示敏感性和特异性的相互关系，它通过将连续变量设定出多个不同的临界值，从而计算出一系列敏感性和特异性，再以敏感性为纵坐标、（1-特异性）为横坐标绘制成曲线，曲线下面积越大，诊断准确性越高。在ROC曲线上，最靠近坐标图左上方的点为敏感性和特异性均较高的临界值. 　　
SPSS统计软件包的10.0版本有ROC曲线的统计功能。ROC曲线真阳性率为纵坐标,假阳性率为横坐标,在座标上由无数个临界值求出的无数对真阳性率和假阳性率作图构成,计算ROC曲线下面积AUCROC来评价诊断效率。



========================================
什么是SSLP和ISSR？
----------------------------------------
什么是SSLP和ISSR？
http://www.cnblogs.com/emanlee/archive/2011/05/29/2062282.html

简单序列长度多态性（simple sequence length polymorphism，SSLP）是据串联重复排列微卫星基序两侧的单一序列设计引物，对微卫星序列（microsatellite DNA或simple sequence repeats，SSR）进行扩增，由微卫星基序重复数目的变异而产生多态性。由于基因组中某一特定的微卫星的侧翼序列通常都是保守性较强的单一序列，因而可以将微卫星侧翼的DNA片段克隆、测序，然后根据微卫星的侧翼序列就可以人工合成引物进行PCR扩增，从而将单个微卫星位点扩增出来。由于单个微卫星位点重复单元在数量上的变异，个体的扩增产物在长度上的变化就产生长度的多态性，这一多态性称为SSLP，每一扩增位点就代表了这一位点的一对等位基因。 SSLP是一些长度不等的重复序列、有多个等位基因位点，它们多为2-4个核苷酸序列重复（也叫微卫星标记），在不同动植物品系中其重复次数不同，故可用 PCR法来检测各该多态性序列的长度，从而快速测定出多种回交后代中标记物的分离方式。
由于微卫星标记在基因组中广泛分布，等位性变异丰富，检测手段简便，稳定可靠而受重视，但是微卫星标记要求已知微卫星两侧单一序列信息而使其发展受到限制，同时微卫星标记具有严格的种属特异性也使其应用上受到限制。

http://liu3305602.blog.163.com/blog/static/148546532007214112732384/


========================================
LOD值 LOD score
----------------------------------------
http://www.cnblogs.com/emanlee/archive/2011/05/29/2062286.html

LOD值 LOD score　　

定义：

确定两个基因座是否在染色体上距离很近，因此可能一起遗传的统计学评估。三个或更多的LOD评价通常显示了两个基因座的位置很紧密。　　      

详解：

遗传学上通常用或然率的常用对数作为标准的衡量方法，该值的对数值称为Lod值或对数优势比：根据两个非此即彼的假设，计算数据的整体或然性，以确定两个基因座或是按一定的重组率而相互连锁的可能性或是互不连锁的可能性；这两种可能性之比，是基因座实际上为连锁的可能性；这个比率的10作底的对数就是对数优势比。为了确定两对基因之间是否存在连锁，一般要求或然比大于1000：1，即Lod>3；而要否定连锁存在，则要求或然小于100：1，即Lod<2。　　                

通常判定连锁关系是以Lod值大小为依据。Lod值为0，意味着连锁假设与不连锁假设的可能性相等；Lod值为正值，有利于连锁；Lod值为负值，表示有一定重组率的连锁。显著的域值是＋3和－2。Lod＝＋3时，连锁的概率为95％。

当Lod>1时,表示存在连锁;
Lod>3时,表示肯定连锁;
Lod<-2时,表示否定连锁.

http://www.ag.ndsu.nodak.edu/plantsci/adv_genetics/genetics/lod/lod02.htm
http://www.nature.com/scitable/definition/lod-score-logarithm-of-odds-152





========================================
生物学上描述DNA/RNA的长度常用的kb、nt、bp是指什么
----------------------------------------
kb=千碱基 kilobase

nt＝核苷酸 nucleotide

bp＝碱基对 base pair


========================================
Gene Ontology （GO）简介 GO分析
----------------------------------------
http://www.cnblogs.com/emanlee/archive/2011/08/02/2125314.html


为了查找某个研究领域的相关信息，生物学家往往要花费大量的时间，更糟糕的是，不同的生物学数据库可能会使用不同的术语，好比是一些方言一样，这让信息查找更加麻烦，尤其是使得机器查找无章可循。Gene Ontology就是为了解决这种问题而发起的一个项目。

     Gene Ontology中最基本的概念是term。GO里面的每一个entry都有一个唯一的数字标记，形如GO:nnnnnnn，还有一个term名，比如"cell", "fibroblast growth factor receptor binding"，或者"signal transduction"。每个term都属于一个ontology，总共有三个ontology，它们分别是molecular function（分子功能）, cellular component（细胞组分）和biological process（生物过程）。

     一个基因product可能会出现在不止一个cellular component里面，也可能会在很多biological process里面起作用，并且在其中发挥不同的molecular function。比如，基因product "cytochrome c" 用molecular function term描述是"oxidoreductase activity"，而用biological process term描述就是"oxidative phosphorylation"和"induction of cell death"，最后，它的celluar component term是"mitochondrial matrix"和"mitochondrial inner membrane"。

     Ontology中的term有两种相互关系，它们分别是is_a关系和part_of关系。is_a关系是一种简单的包含关系，比如A is_a B表示A是B的一个子集/子类。比如nuclear chromosome is_a chromosome。part_of关系要稍微复杂一点，C part_of_D意味着如果C出现，那么它就肯定是D的一部分/组成成分，但C不一定总会出现。比如nucleus part_of cell，核肯定是细胞的一部分，但有的细胞没有核。

     Ontology的结构是一个有向无环图，有点类似于分类树，不同点在于 Ontology的结构中一个term可以有不止一个parent。比如 biological process term "hexose biosynthesis" 有两个parents，它们分别是"hexose metabolism"和"monosaccharide biosynthesis"，这是因为生物合成是代谢的一种，而己糖又是单糖的一种。

 

Gene Ontology （GO）简介

     Gene Ontology（GO）包含了基因参与的生物过程，所处的细胞位置，发挥的分子功能三方面功能信息，并将概念粗细不同的功能概念组织成DAG（有向无环图）的结构。Gene Ontology是一个使用有控制的词汇表和严格定义的概念关系，以有向无环图的形式统一表示各物种的基因功能分类体系，从而较全面地概括了基因的功能信息，纠正了传统功能分类体系中常见的维度混淆问题。在基因表达谱分析中，GO常用于提供基因功能分类标签和基因功能研究的背景知识。利用GO的知识体系和结构特点，旨在发掘与基因差异表达现象关联的单个特征基因功能类或多个特征功能类的组合。

    根据GO的知识体系，使用“功能类”（或者叫做“功能模块”）这一概念具有以下优点：我们认为，单个基因的表达情况的改变不足以反映特定功能/通路的整体变化情况。因为类似人类社会的组织结构，生物体的功能的实现决不仅仅是依靠一两个基因功能的改变来实现的。因此过分着重单个基因表达变化，将会在后期结果处理中严重干扰对于结果的合理分析，导致偏倚性加大，而且是无法避免的。因此利用GO的结构体系，把参与同样功能/通路的基因进行“功能类”层面的抽象和整合，提供比基因更高一层次的抽象结论，对理解疾病的发病机制或药物的作用机理等更有帮助。

    但是该方法也存在一定的不足，由于生物体内部的调控网络可能具有“scale-free network”的特点，个别功能重要的基因（主效基因）具有“Hub节点”的重要特性，它的功能改变可能对于整个网络来说是至关重要的，在这点上，这些重要的基因又具有一定的“自私独裁”特点。而“功能类”之观点模糊了这种差别特性，过于强调“共性”，而忽视了“个性”，这也是“功能类”的一个不足之处，这就需要结合相关的生物学知识才能够实现.

 

基因本体
Gene Ontology

     基因本体（Gene Ontology，GO）是一个在生物信息学领域中广泛使用的本体。它主要包括三个分支: 生物过程、分子功能和细胞组件。

     基因本体是一个有向无环图（DAG）型的本体。目前，GO中使用了is_a和part_of两种关系。

     Ontology: 哲学中称为本体论/存在论，这里本质是指一系列特定的文字可用来形容一些特定的模式、元件或角色，因此在国外的华人生物信息学家中试译为语义(学)。

     GO（gene ontology）对大家而言也许会是一个相对陌生的名词，但是它已经成为生物信息领域中一个极为重要的方法和工具，并正在逐步改变着我们对 biological data的组织和理解方式，它的存在已经大大加快了我们对所拥有的生物数据的整合和利用，我们应该逐步学会理解和掌握这种思想和工具。

     众所周知，sequence based biology中的核心内容即是对序列的Annotation（注释），其中主要包含structural annotation和functional annotation，前者涉及分析sequence在genome中的locus以及exon，intron，promoter等的location，而后者则是推断序列编码产物的功能，也正是我们在六月论题中所着重探讨的。应该说，这二者是相互关联的。

     随着多种生物genome的相继解码，同时大量ESTs以及gene expression profile date的积累，使得annotation的工作量和复杂度大大增加。然而另一方面，大多数基因在不同真核生物中拥有共同的主要生物功能，通过在某些物种中获得的基因或者蛋白质（shared protein）的生物学信息，可以用以解释其他物种中对应的基因或蛋白（especially in comparative genomics）。由于这些繁复的功能信息主要是包含在积累的文献之中，如何有效的提取和综合这些信息就是我们面临的核心困难，这也是GO所要着力解决的问题。通过建立一套具有动态形式的控制字集（controlled vocabulary），来解释真核基因及蛋白在细胞内所扮演的角色，并随着生命科学研究的进步，不断积累和更新。一个ontology会被一个控制字集来描述并给予一定的名称，通过制定“本体”ontologies并运用统计学方法及自然语言处理技术，可以实现知识管理的专家系统控制。

     到目前为止，Gene Ontology Consortium（GO的发起组织）的数据库中有3大独立的ontology被建立起来：biological process生物过程, molecular function分子功能及cellular component细胞组分。而这三个ontology下面又可以独立出不同的亚层次，层层向下构成一个ontologies的树型分支结构。可以说， GO是生物学的统一化工具。

GO的目的：类似于语义网络。是为了生物界有一个统一的数据交流语言。

     因为在生物学界，存在在种种同名异义、异议同名的现象。为此产生了GO项目。 
     概要：GO是用一套统一的词汇表来描述生物学中的分子功能、生物过程和细胞成分。

     其思想大概过程：对于一个基因产品（蛋白质或RNA），用某些词汇来描述它是干什么的或位于细胞哪里、或者参与了哪个生物过程，而这些词汇就是来自GO的Term。

     Term是GO里面的基本描述单元。它结构如下：

Accession：
GO:0005515
Ontology：
molecular function
Synonyms：
related: alpha-2 macroglobulin receptor-associated protein activity
related: protein degradation tagging activity
related: protein tagging activity
exact: protein amino acid binding
alt_id: GO:0045308
Definition：
Interacting selectively with any protein or protein complex (a complex of two or more proteins that may include other nonprotein molecules). [source: GOC:go_curators]
Comment：
None
Subset：
gene_ontology.obo 示例：

[Term]
id: GO:0000003
name: reproduction
namespace: biological_process
alt_id: GO:0019952
alt_id: GO:0050876
def: "The production by an organism of new individuals that contain some portion of their genetic material inherited from that organism." [GOC:go_curators, GOC:isa_complete, ISBN:0198506732]
subset: goslim_generic
subset: goslim_pir
subset: goslim_plant
subset: gosubset_prok
exact_synonym: "reproductive physiological process" []
xref_analog: Wikipedia:Reproduction
is_a: GO:0008150 ! biological_process

 

     说白了，GO就是为了对gene和gene product进行统一注释说明而成了的一个标准。这些注释说明来自称为“Ontology”的一套词汇。


GO(Gene Ontology) 
     介绍：GO 是用一套具有动态(dynamic)形式的控制字汇(controlled vocabulary)，来解释真核生物的基因或蛋白质在细胞内所扮演的角色及生医学方面的知识，同时这些字汇随着生命科学研究的进步，一直不断的累积与改变。一个本体（ontology）会被一个控制字汇(controlled vocabulary)来描述并给予统一的名称，到目前为止，在 Gene Ontology 下有三大独立的本体被建立∶biological process,molecular function 及 cellular component。一个基因或蛋白质可从三个层面进行注解，首先是构成在细胞内的特定组件(cellular 过程(biologicalprocess)，因此科学家试着收集各真核生物(如SGD,MGI,FlyBase,..)的基因或蛋白质，利用已知 component)，其次是此组件在分子功能上所扮演的角色(molecular function)，最后是基因或蛋白质参与的生物的文献资料及序列比较资讯为基础，将所有的真核生物的基因或蛋白质都基于在此系统(Gene ontology)下作注解(annotation)与分类(classification)。 
网址：http://www.geneontology.org/ or http://www.ebi.ac.uk/GO/index.html 
软件：interproscan


Understanding relations in GO
http://www.cnblogs.com/emanlee/archive/2012/04/13/2446147.html






========================================
如何看懂NCBI BLAST输出结果
----------------------------------------
http://www.cnblogs.com/emanlee/archive/2011/11/11/2245397.html

解读报告前需要掌握的概念
alignments 代表比对上的两个序列

hits 表示两个序列比对上的片段

Score 比对得分，如果序列匹配上得分，不一样，减分，分值越高，两个序列相似性越高 
E Value 值越小，越可信，相对的一个统计值。 
Length 输入序列的长度 
Identities 一致性，就是两个序列有多少是一样的 
Query 代表输入序列 
Sbjct 代表数据库中的序列


from: http://blog.163.com/henry_by/blog/static/572653582010101343853958/




========================================
blast+
----------------------------------------
download:
	ftp://ftp.ncbi.nih.gov/blast/executables/blast+/
	ftp://ftp.ncbi.nih.gov/blast/executables/release/2.2.18
	ftp://ftp.ncbi.nih.gov/blast/executables/blast+/2.5.0/


blast formatdb 使用方法介绍
http://www.cnblogs.com/emanlee/archive/2011/11/18/2254604.html


megablast 采用贪婪式算法，速度较一般blast快，多用于数据量大且序列相似性较高的情况。
http://www.cnblogs.com/emanlee/archive/2011/11/19/2254863.html



========================================
k-means k均值聚类的弱点/缺点
----------------------------------------
http://www.cnblogs.com/emanlee/archive/2012/03/06/2381617.html

Similar to other algorithm, K-mean clustering has many weaknesses:

1 When the numbers of data are not so many, initial grouping will determine the cluster significantly.  当数据数量不是足够大时，初始化分组很大程度上决定了聚类，影响聚类结果。 
2 The number of cluster, K, must be determined before hand.  要事先指定K的值。 
3 We never know the real cluster, using the same data, if it is inputted in a different order may produce different cluster if the number of data is a few. 数据数量不多时，输入的数据的顺序不同会导致结果不同。 
4 Sensitive to initial condition. Different initial condition may produce different result of cluster. The algorithm may be trapped in the local optimum. 对初始化条件敏感。 
5 We never know which attribute contributes more to the grouping process since we assume that each attribute has the same weight. 无法确定哪个属性对聚类的贡献更大。 
6 weakness of arithmetic mean is not robust to outliers. Very far data from the centroid may pull the centroid away from the real one. 使用算术平均值对outlier不鲁棒。 
7 The result is circular cluster shape because based on distance.  因为基于距离，故结果是圆形的聚类形状。

 

One way to overcome those weaknesses is to use K-mean clustering only if there are available many data. To overcome outliers problem, we can use median instead of mean.  克服缺点的方法： 使用尽量多的数据；使用中位数代替均值来克服outlier的问题。

Some people pointed out that K means clustering cannot be used for other type of data rather than quantitative data. This is not true! See how you can use multivariate data up to n dimensions (even mixed data type) here. The key to use other type of dissimilarity is in the distance matrix.

 

http://people.revoledu.com/kardi/tutorial/kMean/Weakness.htm







========================================
----------------------------------------




========================================
负二项分布
----------------------------------------
负二项分布(Negative binomial distribution)。在实际生活中，我们可以使用负二项分布描述某种机器在坏掉前，能够工作的天数的分布；某运动员在获取r个奖牌前失败次数的分布等等。


1. 定义
负二项分布也基于伯努利试验，其定义有下面两种形式：

在一系列伯努利试验中，失败次数到达指定次数时，成功次数的离散概率分布
在一系列伯努利试验中，成功次数到达指定次数（记为r）时，失败次数（记为k）的离散概率分布

这两种定义只是将“成功”和“失败”对调，其本质上没差别。由于R中相关函数都采用第二种形式，因此下面将以第二种形式为例。







refer:
https://www.jianshu.com/p/ad24bb90b972
负 字从何而来？ https://www.zhihu.com/question/24253978
R统计学(06): 负二项分布 https://www.jianshu.com/p/d60252dfb8ec
英文公开课:http://open.163.com/movie/2017/5/5/6/MCJQECVBF_MCL7VIT56.html 




========================================
统计学 
----------------------------------------
x2检验（chi-square test）或称卡方检验
http://www.cnblogs.com/emanlee/archive/2008/10/25/1319569.html


========================================
多重假设检验：Bonferroni 和 FDR
----------------------------------------

1.概念
FDR，Q value，adjust p value
p-value：衡量一次检验假阳性率的指标（False positive rate） ；
q value：衡量错误发现率的指标（False discovery rate，简称FDR，所有检验中假阳性的概率）。即使用Q value的这个参 数预估FDR。Q value 需要利用公式从p value 校正计算后得到，所以Q value 通常又被称为adjusted p value。所以一般情况下：我们可以认为Q value = FDR = adjusted p value，即三者是一个东西，虽然有些定义上的细微区别，但是问题也不大。


2.矫正
如要使用的校正办法有两种：Bonferroni 校正；FDR（FalseDiscovery Rate） 校正
(1).Bonferroni 校正
Bonferroni 校正法可以称作是“最简单粗暴有效”的校正方法，它拒绝了所有的假阳性结果发生的可能性，通过对p值的阈值进行校正来实现消除假阳性结果。

Bonferroni 校正的公式为p*(1/n)，其中p为原始阈值，n为总检验次数。

如果像我们举的例子一样，原始的P值为0.05，检验次数为10000次，那么在Bonferroni 校正中，校正的阈值就等于5%/ 10000 = 0.000005，所有P值超过0.00005的结果都被认为是不可靠的。这样的话假阳性结果在10000次检验中出现的次数为 10000 * 0.000005 =0.5，还不到1次。

但是这也存在问题：Bonferroni 委实太过严格，被校正后的阈值拒绝的不只有假阳性结果，很多阳性结果也会被它拒绝。



(2).FDR（FalseDiscovery Rate） 校正
相对Bonferroni 来说，FDR温和得多，这种校正方法不追求完全没有假阳性结果，而是将假阳性结果和真阳性的比例控制在一定范围内。

举个例子，我们最开始设定的情况中进行了10000次检验，这次我们设定FDR<0.05，如果我们的检验对象为差异表达的基因，那么在10000次检验中假如得到了500个基因，那么这500个基因中的假阳性结果小于 500*5% = 25 个。

FDR的计算方法有很多种，这里介绍一个比较常用的：


1)BH（Benjaminiand Hochberg）法：
BH 法需要将总计m次检验的结果按由小到大进行排序，k为其中一次检验结果的P值所对应的排名。
找到符合原始阈值α的最大的k值，满足P(k)<=α*k/m，认为排名从1到k的所有检验存在显著差异，并计算对应的q值公式为q = p*(m/k)。
举个例子，如果我们有总共六个结果进行FDR校正：

Gene	p-value 
G1	P1=0.053
G2	P2=0.001
G3	P3=0.045
G4	P4=0.03
G5	P5=0.02
G6	P6=0.01

Order:
G2	P2=0.001
G6	P6=0.01
G5	P5=0.02
G4	P4=0.03
G3	P3=0.045
G1	P1=0.053

按α=0.05进行计算：
排名第四的 P (4) = 0.03 < 0.05*4/6 = 0.033，符合要求
排名第五的 P (5)= 0.045 > 0.05*5/6 = 0.041，不满足P(k)<=α*k/m. 
因此在这个列表里排名前四的G2,G6,G5,G4 为具有显著差异的基因。


我们也可以用q值进行FDR校正：
G2	P2=0.001	q2=0.001*6/1=0.006
G6	P6=0.01	q6=0.01*6/2=0.03
G5	P5=0.02	q5=0.02*6/3=0.04
G4	P4=0.03	q4=0.03*6/4=0.045
G3	P3=0.045	q3=0.045*6/5=0.054
G1	P1=0.053	q1=0.053*6/6=0.053
其中，G3的q值大于0.05，故G2,G6,G5,G4 为具有显著差异的基因。



refer: https://www.jianshu.com/p/949626b18e69



========================================
Benjamini correction == FDR == adjusted p-value
----------------------------------------
https://www.biostars.org/p/293613/


Benjamini correction is your false discovery rate and it is your adjusted p-value. So you should forget about your p-value after correction. So your test is significant if your adjusted p-value is smaller than criteria (such as 0.05 or 0.01). If you want to more about multiple testing, you can check here



========================================
Mann-whitney 检验算法学习， 及R代码
----------------------------------------

因为有公式，还是看原文好。
有书了尽量看书。
refer:
1.https://blog.csdn.net/qq_34734303/article/details/80296316
2.https://www.jianshu.com/p/8c0e7ce7a290


利用R进行Mann-Whitney U test检验(wilcox_test)：

>s1<-c(6,1,1,1,1,1)
>s2<-c(5,5,5,5,5,0)
>s<-c(s1,s2)
>type<-c(rep(1,6),rep(2,6))
>wd<-as.dataframe(cbind(s,as.factor(type)))
>wilcox_test(s~type,data=wd)
  Asymptotic Wilcoxon-Mann-Whitney test
data:data by type(1,2)
Z=-1.2086,p-value=0.2268
alternative hypothesis:true mu is not equal to 0

根据结果显示，p-value值大于0.05，认为支持原假设，两个样品无差异。





========================================
----------------------------------------


========================================
----------------------------------------


========================================
----------------------------------------



========================================
----------------------------------------


========================================
----------------------------------------


========================================
----------------------------------------


========================================
----------------------------------------


========================================
----------------------------------------



========================================
----------------------------------------




========================================
----------------------------------------


========================================
----------------------------------------


========================================
----------------------------------------



========================================
----------------------------------------




========================================
----------------------------------------


========================================
----------------------------------------



========================================
----------------------------------------




========================================
----------------------------------------


========================================
----------------------------------------


========================================
----------------------------------------



========================================
----------------------------------------




========================================
----------------------------------------


========================================
----------------------------------------



========================================
----------------------------------------




========================================
----------------------------------------



========================================
----------------------------------------


========================================
----------------------------------------


========================================
----------------------------------------


========================================
----------------------------------------

